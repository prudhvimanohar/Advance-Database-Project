CREATE TABLE STUDENT(
 STU_NUM INT IDENTITY(1,1) NOT NULL,
 STU_FNAME VARCHAR(20) NOT NULL,
 STU_LNAME VARCHAR(20) NOT NULL,
 STU_DOB DATE NOT NULL,
 STU_JOIN_DATE DATE NOT NULL,
 STU_EMAIL VARCHAR(20),
 STU_MOB NUMERIC(10) ,
 STU_APPARTMENT VARCHAR(20) NOT NULL,
 STU_CITY VARCHAR(20) NOT NULL,
 STU_STATE VARCHAR(20) NOT NULL,
 STU_COUNTRY VARCHAR(20) NOT NULL,
 STU_ZIP VARCHAR(6) NOT NULL,
 STU_IS_PARENT INT DEFAULT 0,
 STU_IS_GRAD INT DEFAULT 0,
 PRIMARY KEY(STU_NUM)
);
ALTER TABLE STUDENT 
ALTER COLUMN STU_MOB NUMERIC(10)
DELETE STUDENT
INSERT INTO STUDENT(STU_FNAME, STU_LNAME, STU_DOB, STU_JOIN_DATE, STU_EMAIL, STU_MOB, STU_APPARTMENT, STU_CITY, STU_STATE,
STU_COUNTRY, STU_ZIP, STU_IS_PARENT, STU_IS_GRAD) VALUES('Ben', 'Maclair', '1999-06-19', '2016-03-31', 'ben@gmail.com',
9876543210, '14b', 'Toronto', 'Ontario', 'Canada', 'N7C123', 0, 0);
INSERT INTO STUDENT(STU_FNAME, STU_LNAME, STU_DOB, STU_JOIN_DATE, STU_EMAIL, STU_MOB, STU_APPARTMENT, STU_CITY, STU_STATE,
STU_COUNTRY, STU_ZIP, STU_IS_PARENT, STU_IS_GRAD) VALUES('Gen', 'Josh', '2000-05-19', '2016-04-30', 'gen@gmail.com',
9876512340, '15b', 'Toronto', 'Ontario', 'Canada', 'N7C125', 0, 0);
INSERT INTO STUDENT(STU_FNAME, STU_LNAME, STU_DOB, STU_JOIN_DATE, STU_EMAIL, STU_MOB, STU_APPARTMENT, STU_CITY, STU_STATE,
STU_COUNTRY, STU_ZIP, STU_IS_PARENT, STU_IS_GRAD) VALUES('Abhi', 'Mulukut', '2001-06-19', '2016-01-31', 'abhi@gmail.com',
9876546788, '18b', 'Toronto', 'Ontario', 'Canada', 'N7C127', 0, 0);
INSERT INTO STUDENT(STU_FNAME, STU_LNAME, STU_DOB, STU_JOIN_DATE, STU_EMAIL, STU_MOB, STU_APPARTMENT, STU_CITY, STU_STATE,
STU_COUNTRY, STU_ZIP, STU_IS_PARENT, STU_IS_GRAD) VALUES('Terry', 'Maclair', '1990-06-19', '2016-09-30', 'terry@gmail.com',
5196543210, '2987', 'Toronto', 'Ontario', 'Canada', 'N7D123', 1, 0);
INSERT INTO STUDENT(STU_FNAME, STU_LNAME, STU_DOB, STU_JOIN_DATE, STU_EMAIL, STU_MOB, STU_APPARTMENT, STU_CITY, STU_STATE,
STU_COUNTRY, STU_ZIP, STU_IS_PARENT, STU_IS_GRAD) VALUES('Merry', 'Mulukutla', '1999-12-01', '2017-03-31', 'mulukutla@gmail.com',
2276543210, '2930', 'Windsor', 'Ontario', 'Canada', 'N9C123', 0, 0);

SELECT * FROM STUDENT
SELECT * FROM PARENT
DROP TABLE PARENT
CREATE TABLE PARENT(
 STU_NUM INT,
 F_FNAME VARCHAR(20) ,
 F_LNAME VARCHAR(20) ,
 M_FNAME VARCHAR(20) ,
 M_LNAME VARCHAR(20) ,
 PAR_EMAIL VARCHAR(20),
 PAR_MOB NUMERIC(10) ,
PRIMARY KEY(STU_NUM),
	 CONSTRAINT STU_NUM_FK FOREIGN KEY (STU_NUM) REFERENCES STUDENT(STU_NUM)
)
SELECT * FROM STUDENT
DELETE PARENT
INSERT INTO PARENT VALUES(1, 'Mark', 'Maclair', 'Merry', 'Maclair', 'mark@gmail.com', 2276543230);
INSERT INTO PARENT VALUES(2, 'Len', 'Josh','Linda', 'Josh', 'len@gmail.com', 2276543456);
INSERT INTO PARENT VALUES(3, 'Prudhvi', 'Mulukut','Sharanya', 'Mulukut', 'prudhvi@gmail.com', 5186543230);
INSERT INTO PARENT VALUES(4, 'Perry', 'Mulukutla','Hemal','Mulukutla', 'perry@gmail.com', 2016543230);

CREATE TABLE FEE(
 FEE_RECEIPT_ID INT IDENTITY(1,1) NOT NULL,
 STU_NUM INT,
 FEE_DATE DATE,
 FEE_AMOUNT INT, 
 FEE_DESC VARCHAR(20),
 PRIMARY KEY(FEE_RECEIPT_ID),
	 CONSTRAINT STU_NUM_FEE_FK FOREIGN KEY (STU_NUM) REFERENCES STUDENT(STU_NUM)
)
SELECT * FROM FEE
SELECT * FROM STUDENT
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(1, '2016-04-25', 1000, 'Base Tution Fee');
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(1, '2016-12-25', 500, 'Lab Tution Fee');
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(1, '2017-01-25', 1000, 'Failure Fee');
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(1, '2017-03-25', 300, 'Graduation Fee');

INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(2, '2016-04-30', 1000, 'Base Tution Fee');
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(2, '2016-05-25', 500, 'Lab Tution Fee');

INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(3, '2016-02-05', 1000, 'Base Tuition Fee');
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(3, '2016-12-25', 300, 'Graduation Fee');

INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(4, '2017-04-01', 1000, 'Base Tution Fee');
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(4, '2017-06-25', 500, 'Lab Tution Fee');

INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(5, '2016-10-30', 1000, 'Base Tution Fee');
INSERT INTO FEE(STU_NUM, FEE_DATE, FEE_AMOUNT, FEE_DESC) VALUES(5, '2017-06-25', 300, 'Graduation Fee');
select * from CLASS
DROP TABLE CLASS
DELETE CLASS 
CREATE TABLE CLASS(
 CLASS_ID INT NOT NULL,
 CLASS_TIME TIME,
 CLASS_LOCATION VARCHAR(30),
 CLASS_WEEK INT CHECK(CLASS_WEEK IN (1,2,3,4,5,6,7)),
 CLASS_LEVEL VARCHAR(30) CHECK(CLASS_LEVEL IN('BEGINNER', 'INTERMEDIATE', 'ADVANCE')),
  PRIMARY KEY(CLASS_ID)
)
 INSERT INTO CLASS VALUES(100, '2017-06-25', 300, 'Graduation Fee');
ALTER TABLE INSTRUCTOR 
ALTER COLUMN INST_MOB NUMERIC(10)
SELECT * FROM STUDENT
SELECT * FROM CLASS
INSERT INTO CLASS VALUES(100, '15:00:00', 'CAW', 1, 'BEGINNER');
INSERT INTO CLASS VALUES(103,'15:00:00', 'CAW', 2, 'INTERMEDIATE');

INSERT INTO CLASS VALUES(105,'15:00:00', 'CAW', 3, 'ADVANCE');

CREATE TABLE INSTRUCTOR(
 INST_ID INT IDENTITY(300,1) NOT NULL,
 CLASS_ID INT,
 INST_FNAME VARCHAR(20) NOT NULL,
 INST_LNAME VARCHAR(20) NOT NULL,
 INST_EMAIL VARCHAR(20),
 INST_MOB NUMERIC(10),
 INST_HIRE_DATE DATE,
 INST_STATUS VARCHAR(5) CHECK(INST_STATUS IN('YES', 'NO')),
 PRIMARY KEY(INST_ID),
 CONSTRAINT CLASS_ID_FK FOREIGN KEY (CLASS_ID) REFERENCES CLASS(CLASS_ID)

)
INSERT INTO INSTRUCTOR(CLASS_ID, INST_FNAME, INST_LNAME, INST_EMAIL, INST_MOB, INST_HIRE_DATE, INST_STATUS) 
VALUES(100, 'TRACY', 'WILLIAM', 'tracy@gmail.com', 9876543211, '1995-02-01', 'YES');

INSERT INTO INSTRUCTOR(CLASS_ID, INST_FNAME, INST_LNAME, INST_EMAIL, INST_MOB, INST_HIRE_DATE, INST_STATUS) 
VALUES(103, 'TRACY', 'WILLIAM', 'tracy@gmail.com', 9876543211, '1995-02-01', 'YES');

INSERT INTO INSTRUCTOR(CLASS_ID, INST_FNAME, INST_LNAME, INST_EMAIL, INST_MOB, INST_HIRE_DATE, INST_STATUS) 
VALUES(105, 'TRACY', 'WILLIAM', 'tracy@gmail.com', 9876543211, '1995-02-01', 'YES');
CREATE TABLE TIMETABLES(
 TIME_NUM INT IDENTITY(1000, 1) NOT NULL,
 TIME_DATE DATE,
 CLASS_ID_1 INT,
 PRIMARY KEY(TIME_NUM),
 CONSTRAINT CLASS_TIMES_FK FOREIGN KEY (CLASS_ID_1) REFERENCES CLASS(CLASS_ID)
 )
SELECT * FROM TIMETABLES
INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-03-07', 100);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-03-14', 100);
INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-03-21', 100);
INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-03-08', 103);
INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-03-09', 105);
INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-05-09', 100);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-05-23', 100);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-02-01', 100);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-03-02', 103);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-10-10', 100);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-10-05', 105);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2017-04-04', 103);

INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2017-04-19', 105);


INSERT INTO TIMETABLES(TIME_DATE, CLASS_ID_1) 
VALUES('2016-03-07', 100);
CREATE TABLE ATTENDANCE(
 ATTEND_NUM INT IDENTITY(1,1),
 STU_NUM INT NOT NULL,
 CLASS_ID_2 INT NOT NULL,
 ATTEND_ROLE INT CHECK(ATTEND_ROLE IN(0, 1)) DEFAULT 0,
 ATTEND_DATE DATE,
 PRIMARY KEY(ATTEND_NUM),
  FOREIGN KEY (STU_NUM) REFERENCES STUDENT(STU_NUM),
    FOREIGN KEY (CLASS_ID_2) REFERENCES CLASS(CLASS_ID)  
 --CONSTRAINT ATTEND_CLASS1_FK FOREIGN KEY (CLASS_ID_2) REFERENCES TIMETABLES(CLASS_ID_1)
)
ALTER TABLE ATTENDANCE
ADD ATTEND_DATE DATE
SELECT * FROM TIMETABLES
DELETE ATTENDANCE
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(1, 100, 1,'2016-03-07');

INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(1, 103, 0,'2016-03-08');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(1, 105, 1,'2016-03-09');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(2, 100, 1,'2016-10-10');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(2, 105, 1,'2017-04-19');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(3, 100, 0,'2016-02-01');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(3, 105, 1,'2016-03-09');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(3, 103, 1,'2016-03-08');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(4, 103, 1,'2017-04-04');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(4, 100, 0,'2016-03-07');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(5, 105, 1,'2016-03-09');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(5, 100, 1,'2016-10-10');
INSERT INTO ATTENDANCE(STU_NUM, CLASS_ID_2, ATTEND_ROLE, ATTEND_DATE) VALUES(5, 103, 1,'2016-03-08');
CREATE TABLE RANK_TABLE(
  RANK_NUM INT CHECK(RANK_NUM IN(1,2,3,4,5,6,7,8,9,10)) DEFAULT 1,
  RANK_COLOR VARCHAR(20) DEFAULT 'WHITE',
  PRIMARY KEY (RANK_NUM)
)
ALTER TABLE RANK_TABLE 
DROP COLUMN RANK_NAME
INSERT INTO RANK_TABLE VALUES(1, 'WHITE');

INSERT INTO RANK_TABLE VALUES(2, 'Yellow');
INSERT INTO RANK_TABLE VALUES(3, 'Half Green');
INSERT INTO RANK_TABLE VALUES(4, 'Green');
INSERT INTO RANK_TABLE VALUES(5, 'Half Blue');
INSERT INTO RANK_TABLE VALUES(6, 'Blue');
INSERT INTO RANK_TABLE VALUES(7, 'Half Red');
INSERT INTO RANK_TABLE VALUES(8, 'Red');
INSERT INTO RANK_TABLE VALUES(9, 'Half Black');
INSERT INTO RANK_TABLE VALUES(10, 'Black');
CREATE TABLE ACHIEVEMENT(
 RANK_NUM INT,
 STU_NUM INT,
 ACHIE_DATE DATE,
 PRIMARY KEY(RANK_NUM, STU_NUM),
 CONSTRAINT ACHIE_RANK_FK FOREIGN KEY (RANK_NUM) REFERENCES RANK_TABLE(RANK_NUM),
 CONSTRAINT ACHIE_STU_FK FOREIGN KEY (STU_NUM) REFERENCES STUDENT(STU_NUM)
)
select * from STUDENT
INSERT INTO ACHIEVEMENT VALUES(1, 1, '2016-03-31');
INSERT INTO ACHIEVEMENT VALUES(1, 2, '2016-04-30');
INSERT INTO ACHIEVEMENT VALUES(1, 3, '2016-01-31');
INSERT INTO ACHIEVEMENT VALUES(1, 4, '2016-09-30');
INSERT INTO ACHIEVEMENT VALUES(1, 5, '2017-03-31');

INSERT INTO ACHIEVEMENT VALUES(2, 1, '2016-04-30');
INSERT INTO ACHIEVEMENT VALUES(2, 2, '2016-05-31');
INSERT INTO ACHIEVEMENT VALUES(3, 1, '2016-05-31');
INSERT INTO ACHIEVEMENT VALUES(4, 1, '2016-06-30');
INSERT INTO ACHIEVEMENT VALUES(5, 1, '2016-07-31');
select * from ACHIEVEMENT

select * from fee
--selecting student who got white belt
select S.STU_FNAME, S.STU_LNAME from STUDENT S
LEFT OUTER JOIN ACHIEVEMENT A ON S.STU_NUM = A.STU_NUM 
LEFT OUTER JOIN RANK_TABLE R ON A.RANK_NUM = R.RANK_NUM 
WHERE R.RANK_COLOR = 'White'
--student who paid fee on april
select s.stu_fname, s.stu_lname from STUDENT s
left outer join FEE f on s.STU_NUM = f.STU_NUM 
where f.FEE_DATE between '2016-04-01' and '2016-04-30'
--student who attended for class 100
select s.stu_fname, s.stu_lname from STUDENT s
left outer join TIMETABLES t on s.STU_NUM = t.STU_NUM
left outer join ATTENDANCE a on t.CLASS_ID_1 = a.CLASS_ID_2 and t.TIME_NUM=a.TIME_NUM_1
where a.CLASS_ID_2 = 100 and a.ATTEND_ROLE = 1

select s.stu_fname, s.stu_lname, s.STU_NUM from STUDENT s
left outer join ATTENDANCE a on a.STU_NUM = s.STU_NUM 
where a.CLASS_ID_2 = 103 and a.ATTEND_ROLE = 1
select * from ATTENDANCE

select s.stu_fname, s.stu_lname, s.STU_NUM, t.TIME_DATE from STUDENT s
left outer join ATTENDANCE a on a.STU_NUM = s.STU_NUM 
left outer join CLASS c on c.CLASS_ID = a.CLASS_ID_2
left outer join TIMETABLES t on t.CLASS_ID_1 = c.CLASS_ID where
t.TIME_DATE between '2016-03-01' and '2016-03-31'

SELECT S.STU_FNAME,S.STU_LNAME,A.CLASS_ID_2,A.ATTEND_DATE FROM STUDENT S
LEFT OUTER JOIN ATTENDANCE A ON A.STU_NUM=S.STU_NUM
WHERE S.STU_NUM=1 AND A.ATTEND_DATE BETWEEN '2016-03-01' AND '2016-03-31' 
AND A.ATTEND_ROLE=0
select * from ATTENDANCE
select * from CLASS
select * from TIMETABLES




select * from ATTENDANCE
select * from TIMETABLES